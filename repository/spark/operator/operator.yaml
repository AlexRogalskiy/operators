apiVersion: kudo.dev/v1beta1
name: "spark"
operatorVersion: "beta1"
kudoVersion: 0.10.0
kubernetesVersion: 1.15.0
appVersion: "2.4.3"
maintainers:
  - name: Anton Kirillov
    email: akirillov@d2iq.com
  - name: Alexander Lembiewski
    email: alembiyeuski.c@d2iq.com
url: https://spark.apache.org/
tasks:
  - name: deploy-cluster-scoped-resources
    kind: Apply
    spec:
      resources:
        - spark-operator-crds.yaml
        - spark-operator-rbac.yaml
  - name: deploy-sa
    kind: Apply
    spec:
      resources:
        - spark-operator-serviceaccount.yaml
        - spark-rbac.yaml
        - spark-serviceaccount.yaml
  - name: deploy-webhook
    kind: Apply
    spec:
      resources:
        - webhook-init-job.yaml
        - webhook-service.yaml
  - name: deploy-spark-components
    kind: Apply
    spec:
      resources:
        - spark-operator-deployment.yaml
        - spark-history-server-deployment.yaml
        - spark-history-server-service.yaml
        - spark-monitoring.yaml

plans:
  deploy:
    strategy: serial
    phases:
      - name: deploy-spark-operator
        strategy: serial
        steps:
          - name: deploy-cluster-scoped-resources
            tasks:
              - deploy-cluster-scoped-resources
          - name: deploy-sa
            tasks:
              - deploy-sa
          - name: deploy-webhook
            tasks:
              - deploy-webhook
          - name: deploy-spark-components
            tasks:
              - deploy-spark-components
